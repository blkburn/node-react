(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{106:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n(25),s=n.n(r),c=n(9),o=n(41),i=n(65),u=n(66),l=n(10),d="USER_LOGIN_REQUEST",j="USER_LOGIN_SUCCESS",p="USER_LOGIN_FAIL",h="USER_LOGIN_ERROR_CLEAR",b="USER_LOGOUT",f="USER_REGISTER_REQUEST",O="USER_REGISTER_SUCCESS",m="USER_REGISTER_ERROR_CLEAR",g="USER_REGISTER_FAIL",x="USER_DETAILS_REQUEST",y="USER_DETAILS_SUCCESS",v="USER_DETAILS_FAIL",E="USER_DETAILS_RESET",S="USER_UPDATE_PROFILE_REQUEST",_="USER_UPDATE_PROFILE_SUCCESS",R="USER_UPDATE_PROFILE_FAIL",I="USER_UPDATE_PROFILE_RESET",L="USER_LIST_REQUEST",w="USER_LIST_SUCCESS",k="USER_LIST_FAIL",C="USER_LIST_RESET",N="USER_DELETE_REQUEST",U="USER_DELETE_SUCCESS",A="USER_DELETE_FAIL",T="USER_UPDATE_REQUEST",D="USER_UPDATE_SUCCESS",G="USER_UPDATE_FAIL",P="USER_UPDATE_RESET",z="ROTA_SET_RUNNING",F="ROTA_STOP_RUNNING",B="ROTA_SET_SHEET",M="ROTA_SET_SHEET_NAME",Q="ROTA_SHEET_VALID",J="ROTA_SET_LOCKED",H="ROTA_APPEND_MESSAGE",K="ROTA_CLEAR_MESSAGE",V="ROTA_CLEAR_COUNT",Z="ROTA_INC_COUNT",W=n(71),q=Object(o.combineReducers)({userLogin:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case d:return{loading:!0};case j:return{loading:!1,userInfo:t.payload};case p:return{loading:!1,error:t.payload};case h:return{loading:!1,userInfo:t.payload};case b:return{};default:return e}},userRegister:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f:return{loading:!0};case O:return{loading:!1,userInfo:t.payload};case g:return{loading:!1,error:t.payload};case m:return{loading:!1};case b:return{};default:return e}},userDetails:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{user:{}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case x:return Object(l.a)(Object(l.a)({},e),{},{loading:!0});case y:return{loading:!1,user:t.payload};case v:return{loading:!1,error:t.payload};case E:return{user:{}};default:return e}},userUpdateProfile:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case S:return{loading:!0};case _:return{loading:!1,success:!0,userInfo:t.payload};case R:return{loading:!1,error:t.payload};case I:return{};default:return e}},userList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{users:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case L:return{loading:!0};case w:return{loading:!1,users:t.payload};case k:return{loading:!1,error:t.payload};case C:return{users:[]};default:return e}},userDelete:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N:return{loading:!0};case U:return{loading:!1,success:!0};case A:return{loading:!1,error:t.payload};default:return e}},userUpdate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{user:{}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case T:return{loading:!0};case D:return{loading:!1,success:!0};case G:return{loading:!1,error:t.payload};case P:return{user:{}};default:return e}},rota:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{message:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case B:return Object(l.a)(Object(l.a)({},e),{},{sheet:t.payload,locked:!0,count:0});case M:return Object(l.a)(Object(l.a)({},e),{},{name:t.payload});case Q:return Object(l.a)(Object(l.a)({},e),{},{valid:t.payload});case J:return Object(l.a)(Object(l.a)({},e),{},{locked:t.payload});case z:return Object(l.a)(Object(l.a)({},e),{},{running:!0});case F:return Object(l.a)(Object(l.a)({},e),{},{running:!1});case V:return Object(l.a)(Object(l.a)({},e),{},{count:0});case Z:return Object(l.a)(Object(l.a)({},e),{},{count:e.count+1});case H:return Object(l.a)(Object(l.a)({},e),{},{message:[].concat(Object(W.a)(e.message),[t.payload])});case K:return Object(l.a)(Object(l.a)({},e),{},{message:[]});default:return e}}}),X={userLogin:{userInfo:localStorage.getItem("userInfo")?JSON.parse(localStorage.getItem("userInfo")):null}},Y=[i.a],$=Object(o.createStore)(q,X,Object(u.composeWithDevTools)(o.applyMiddleware.apply(void 0,Y))),ee=(n(79),n(80),n(24)),te=n(12),ne=n(117),ae=n(111),re=n(118),se=n(115),ce=n(31),oe=n(6),ie=n.n(oe),ue=n(11),le=n(20),de=n.n(le),je=function(){return function(e){localStorage.removeItem("userInfo"),e({type:b}),e({type:E}),e({type:C}),document.location.href="/login"}},pe=function(e){return function(){var t=Object(ue.a)(ie.a.mark((function t(n,a){var r,s,c,o,i,u;return ie.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n({type:x}),r=a(),s=r.userLogin.userInfo,c={headers:{Authorization:"Bearer ".concat(s.token)}},t.next=6,de.a.get("/api/users/".concat(e),c);case 6:o=t.sent,i=o.data,n({type:y,payload:i}),t.next=16;break;case 11:t.prev=11,t.t0=t.catch(0),"Not authorized, token failed"===(u=t.t0.response&&t.t0.response.data.message?t.t0.response.data.message:t.t0.message)&&n(je()),n({type:v,payload:u});case 16:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e,n){return t.apply(this,arguments)}}()},he=n(1),be=function(){var e=Object(c.b)(),t=Object(c.c)((function(e){return e.userLogin})).userInfo;return Object(he.jsx)("header",{children:Object(he.jsx)(ne.a,{bg:"light",expand:"lg",children:Object(he.jsxs)(ae.a,{children:[Object(he.jsx)(ne.a.Brand,{children:"Rota"}),Object(he.jsx)(ne.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(he.jsx)(ne.a.Collapse,{id:"basic-navbar-nav",children:Object(he.jsxs)(re.a,{className:"ms-auto",children:[Object(he.jsx)(ce.LinkContainer,{to:"/",children:Object(he.jsxs)(re.a.Link,{children:[Object(he.jsx)("i",{className:"fas fa-home pe-1"})," Home"]})}),t?Object(he.jsxs)(se.a,{title:t.name,id:"username",children:[Object(he.jsx)(ce.LinkContainer,{to:"/profile",children:Object(he.jsx)(se.a.Item,{children:"Profile"})}),Object(he.jsx)(se.a.Item,{onClick:function(){e(je())},children:"Logout"})]}):Object(he.jsxs)(he.Fragment,{children:[Object(he.jsx)(ce.LinkContainer,{to:"/login",children:Object(he.jsxs)(re.a.Link,{children:[Object(he.jsx)("i",{className:"fas fa-user pe-1"})," Login"]})}),Object(he.jsx)(ce.LinkContainer,{to:"/register",children:Object(he.jsxs)(re.a.Link,{children:[Object(he.jsx)("i",{className:"fas fa-registered pe-1"})," Register"]})})]}),t&&t.isAdmin&&Object(he.jsx)(se.a,{title:"Admin",id:"adminmenu",children:Object(he.jsx)(ce.LinkContainer,{to:"/admin/userlist",children:Object(he.jsx)(se.a.Item,{children:"Users"})})})]})})]})})})},fe=n(112),Oe=n(70),me=function(){return Object(he.jsx)("footer",{children:Object(he.jsx)(ae.a,{children:Object(he.jsx)(fe.a,{children:Object(he.jsx)(Oe.a,{className:"text-center py-3",children:"Copyright \xa9 2021"})})})})},ge=n(116),xe=n(69),ye=function(e){var t=e.children;return Object(he.jsx)(ae.a,{children:Object(he.jsx)(fe.a,{className:"justify-content-md-center",children:Object(he.jsx)(Oe.a,{xs:12,md:6,children:t})})})},ve=function(e,t){return console.log(t),e({type:"ROTA_FAIL",payload:t.response&&t.response.data.message?t.response.data.message:t.message})},Ee=function(){return function(){var e=Object(ue.a)(ie.a.mark((function e(t){return ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{t({type:K})}catch(n){ve(t,n)}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},Se=function(e){return function(){var t=Object(ue.a)(ie.a.mark((function t(n){return ie.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{console.log("msg : ".concat(e)),e&&n({type:H,payload:e})}catch(a){ve(n,a)}case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},_e=function(){return function(){var e=Object(ue.a)(ie.a.mark((function e(t){return ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{t({type:z})}catch(n){ve(t,n)}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},Re=function(e){return function(){var t=Object(ue.a)(ie.a.mark((function t(n){return ie.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{n({type:Q,payload:e})}catch(a){ve(n,a)}case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},Ie=function(){return function(){var e=Object(ue.a)(ie.a.mark((function e(t){return ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{t({type:V})}catch(n){ve(t,n)}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},Le=function(){return function(){var e=Object(ue.a)(ie.a.mark((function e(t){return ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{t({type:Z})}catch(n){ve(t,n)}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},we=function(e){return function(t){var n;t(Ie()),t(function(){var e=Object(ue.a)(ie.a.mark((function e(t){return ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{t({type:F})}catch(n){ve(t,n)}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t((n="TRUE"===e.locked,function(){var e=Object(ue.a)(ie.a.mark((function e(t){return ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{t({type:J,payload:n})}catch(a){ve(t,a)}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),"TRUE"===e.locked?(console.log("sheet locked"),t(Se("Sheet is LOCKED"))):(console.log("sheet unlocked"),t(Se("Sheet is UNLOCKED"))),t(Re(!0))}},ke=function(e){var t=Object(c.b)(),n=(Object(c.c)((function(e){return e.userLogin})).userInfo,Object(c.c)((function(e){return e.rota})));Object(a.useEffect)((function(){console.log("rota count ".concat(n.count));var e=function(){t(function(){var e=Object(ue.a)(ie.a.mark((function e(t,n){var a,r,s,c,o,i;return ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=n(),r=a.userLogin.userInfo,s={headers:{Authorization:"Bearer ".concat(r.token)}},e.next=5,de.a.get("/api/rota/status",s);case 5:c=e.sent,o=c.data,console.log(o),o.running?t(Le()):t(we(o)),""!==o.message&&t(Se(o.message)),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),i=e.t0.response&&e.t0.response.data.message?e.t0.response.data.message:e.t0.message,t({type:H,payload:i});case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t,n){return e.apply(this,arguments)}}())};if(n.running&&n.count>0){setTimeout((function(){return e()}),1e3)}else console.log("running is false")}),[n.count,n.running,t]),Object(a.useEffect)((function(){console.log("screen refresh"),t(Re(!1))}),[t]);return Object(he.jsxs)(ye,{children:[Object(he.jsx)("h1",{children:"Create Rota"}),Object(he.jsxs)(ge.a,{onSubmit:function(e){e.preventDefault(),t(function(){var e=Object(ue.a)(ie.a.mark((function e(t,n){var a,r,s,c,o,i,u,l;return ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("verfy sheet"),t(Ie()),t(Ee()),t(_e()),t(Re(!1)),a=n(),r=a.userLogin.userInfo,s=a.rota,c={headers:{Authorization:"Bearer ".concat(r.token)}},o=new RegExp("/spreadsheets/d/([a-zA-Z0-9-_]+)").exec(s.sheet)[1],console.log(o),e.next=12,de.a.post("/api/rota/verify",{sheet:o},c);case 12:i=e.sent,u=i.data,console.log(u),u.running?(t(Le()),t(Re(!1)),""!==u.message&&t(Se(u.message))):t(we(u)),e.next=23;break;case 18:e.prev=18,e.t0=e.catch(0),console.log(e.t0),l=e.t0.response&&e.t0.response.data.message?e.t0.response.data.message:e.t0.message,t({type:H,payload:l});case 23:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(t,n){return e.apply(this,arguments)}}())},children:[Object(he.jsxs)(ge.a.Group,{controlId:"name",children:[Object(he.jsx)(ge.a.Label,{className:"my-2",children:"Sheet Name"}),Object(he.jsx)(ge.a.Control,{type:"name",placeholder:"Enter sheet URL",value:n.sheet,onChange:function(e){var n;t(Re(!1)),t(Ee()),t((n=e.target.value,function(){var e=Object(ue.a)(ie.a.mark((function e(t){return ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{t({type:B,payload:n})}catch(a){ve(t,a)}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))}})]}),Object(he.jsx)(xe.a,{className:"my-3",type:"submit",disabled:n.running||n.valid,variant:"primary",children:n.valid?n.locked?Object(he.jsx)("i",{className:"fas fa-lock"}):Object(he.jsx)("i",{className:"fas fa-unlock"}):"Verify Sheet"})]}),Object(he.jsxs)(ge.a,{onSubmit:function(e){e.preventDefault(),t(function(){var e=Object(ue.a)(ie.a.mark((function e(t,n){var a,r,s,c,o,i,u,l;return ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("run sheet"),t(Ie()),t(_e()),a=n(),r=a.userLogin.userInfo,s=a.rota,c={headers:{Authorization:"Bearer ".concat(r.token)}},o=new RegExp("/spreadsheets/d/([a-zA-Z0-9-_]+)").exec(s.sheet)[1],console.log(o),e.next=10,de.a.post("/api/rota/run",{sheet:o,locked:s.locked?"true":"false"},c);case 10:i=e.sent,u=i.data,console.log(u),u.running?(t(Le()),""!==u.message&&t(Se(u.message))):t(we(u)),e.next=21;break;case 16:e.prev=16,e.t0=e.catch(0),console.log(e.t0),l=e.t0.response&&e.t0.response.data.message?e.t0.response.data.message:e.t0.message,t({type:H,payload:l});case 21:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(t,n){return e.apply(this,arguments)}}())},children:[Object(he.jsxs)(ge.a.Group,{controlId:"name",children:[Object(he.jsx)(ge.a.Label,{className:"my-2",children:"Rota Name"}),Object(he.jsx)(ge.a.Control,{type:"name",placeholder:"Enter rota name",value:n.name,onChange:function(e){return t((n=e.target.value,function(){var e=Object(ue.a)(ie.a.mark((function e(t){return ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{t({type:M,payload:n})}catch(a){ve(t,a)}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));var n}})]}),Object(he.jsx)(xe.a,{className:"my-3",disabled:n.running||!n.valid,type:"submit",variant:"primary",children:n.locked?"Generate Metrics":"Run"}),Object(he.jsx)(ge.a.Control,{as:"textarea",placeholder:"Leave a comment here",style:{height:"300px"},value:n.message.join("\n"),onChange:function(e){return null}})]})]})},Ce=function(){var e=Object(c.c)((function(e){return e.userLogin})).userInfo;return Object(he.jsx)("div",{className:"homepage",children:e?Object(he.jsx)(ke,{}):Object(he.jsx)("img",{src:"https://source.unsplash.com/1600x900/?nature,water",alt:"homepage pic"})})},Ne=n(15),Ue=n(119),Ae=function(e){var t=e.variant,n=e.children;return Object(he.jsx)(Ue.a,{variant:t,children:n})};Ae.defaultProps={variant:"info"};var Te=Ae,De=n(113),Ge=function(){return Object(he.jsx)(De.a,{animation:"border",role:"status",style:{width:"100px",height:"100px",margin:"auto",display:"block"},children:Object(he.jsx)("span",{className:"sr-only",children:"Loading..."})})},Pe=function(e){var t=e.location,n=e.history,r=Object(a.useState)(""),s=Object(Ne.a)(r,2),o=s[0],i=s[1],u=Object(a.useState)(""),l=Object(Ne.a)(u,2),b=l[0],f=l[1],O=Object(c.b)(),m=Object(c.c)((function(e){return e.userLogin})),g=m.loading,x=m.error,y=m.userInfo,v=t.search?t.search.split("=")[1]:"/";Object(a.useEffect)((function(){y&&n.push(v)}),[n,y,v]),Object(a.useEffect)((function(){O({type:h})}),[O]);return Object(he.jsxs)(ye,{children:[Object(he.jsx)("h1",{children:"Sign In"}),x&&Object(he.jsx)(Te,{variant:"danger",children:x}),g&&Object(he.jsx)(Ge,{}),Object(he.jsxs)(ge.a,{onSubmit:function(e){e.preventDefault(),O(function(e,t){return function(){var n=Object(ue.a)(ie.a.mark((function n(a){var r,s,c;return ie.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,a({type:d}),r={headers:{"Content-Type":"application/json"}},n.next=5,de.a.post("/api/users/login",{email:e,password:t},r);case 5:s=n.sent,c=s.data,a({type:j,payload:c}),localStorage.setItem("userInfo",JSON.stringify(c)),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(0),a({type:p,payload:n.t0.response&&n.t0.response.data.message?n.t0.response.data.message:n.t0.message});case 14:case"end":return n.stop()}}),n,null,[[0,11]])})));return function(e){return n.apply(this,arguments)}}()}(o,b))},children:[Object(he.jsxs)(ge.a.Group,{controlId:"email",children:[Object(he.jsx)(ge.a.Label,{className:"my-2",children:"Email Address"}),Object(he.jsx)(ge.a.Control,{type:"email",placeholder:"Enter email",value:o,onChange:function(e){return i(e.target.value)}})]}),Object(he.jsxs)(ge.a.Group,{controlId:"password",children:[Object(he.jsx)(ge.a.Label,{className:"my-2",children:"Password"}),Object(he.jsx)(ge.a.Control,{type:"password",placeholder:"Enter password",value:b,onChange:function(e){return f(e.target.value)}})]}),Object(he.jsx)(xe.a,{className:"my-3",type:"submit",variant:"primary",children:"Sign In"})]}),Object(he.jsx)(fe.a,{className:"py-3",children:Object(he.jsxs)(Oe.a,{children:["New Customer?"," ",Object(he.jsx)(ee.Link,{to:v?"/register?redirect=".concat(v):"/register",children:"Register"})]})})]})},ze=function(e){var t=e.location,n=e.history,r=Object(a.useState)(""),s=Object(Ne.a)(r,2),o=s[0],i=s[1],u=Object(a.useState)(""),l=Object(Ne.a)(u,2),d=l[0],p=l[1],h=Object(a.useState)(""),b=Object(Ne.a)(h,2),x=b[0],y=b[1],v=Object(a.useState)(""),E=Object(Ne.a)(v,2),S=E[0],_=E[1],R=Object(a.useState)(null),I=Object(Ne.a)(R,2),L=I[0],w=I[1],k=Object(c.b)(),C=Object(c.c)((function(e){return e.userRegister})),N=C.loading,U=C.error,A=C.userInfo,T=t.search?t.search.split("=")[1]:"/";Object(a.useEffect)((function(){A&&n.push(T)}),[n,A,T]),Object(a.useEffect)((function(){k({type:m})}),[k]);return Object(he.jsxs)(ye,{children:[Object(he.jsx)("h1",{children:"Register"}),L&&Object(he.jsx)(Te,{variant:"danger",children:L}),U&&Object(he.jsx)(Te,{variant:"danger",children:U}),N&&Object(he.jsx)(Ge,{}),Object(he.jsxs)(ge.a,{onSubmit:function(e){e.preventDefault(),x!==S?w("Passwords do not match"):k(function(e,t,n){return function(){var a=Object(ue.a)(ie.a.mark((function a(r){var s,c,o;return ie.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,r({type:f}),s={headers:{"Content-Type":"application/json"}},a.next=5,de.a.post("/api/users/register",{name:e,email:t,password:n},s);case 5:c=a.sent,o=c.data,r({type:O,payload:o}),r({type:j,payload:o}),localStorage.setItem("userInfo",JSON.stringify(o)),a.next=16;break;case 12:a.prev=12,a.t0=a.catch(0),console.log(a.t0),r({type:g,payload:a.t0.response&&a.t0.response.data.message?a.t0.response.data.message:a.t0.message});case 16:case"end":return a.stop()}}),a,null,[[0,12]])})));return function(e){return a.apply(this,arguments)}}()}(d,o,x))},children:[Object(he.jsxs)(ge.a.Group,{controlId:"name",children:[Object(he.jsx)(ge.a.Label,{className:"my-2",children:"Name"}),Object(he.jsx)(ge.a.Control,{type:"name",placeholder:"Enter name",value:d,onChange:function(e){return p(e.target.value)}})]}),Object(he.jsxs)(ge.a.Group,{controlId:"email",children:[Object(he.jsx)(ge.a.Label,{className:"my-2",children:"Email Address"}),Object(he.jsx)(ge.a.Control,{type:"email",placeholder:"Enter email",value:o,onChange:function(e){return i(e.target.value)}})]}),Object(he.jsxs)(ge.a.Group,{controlId:"password",children:[Object(he.jsx)(ge.a.Label,{className:"my-2",children:"Password"}),Object(he.jsx)(ge.a.Control,{type:"password",placeholder:"Enter password",value:x,onChange:function(e){return y(e.target.value)}})]}),Object(he.jsxs)(ge.a.Group,{controlId:"confirmPassword",children:[Object(he.jsx)(ge.a.Label,{className:"my-2",children:"Confirm Password"}),Object(he.jsx)(ge.a.Control,{type:"password",placeholder:"Confirm password",value:S,onChange:function(e){return _(e.target.value)}})]}),Object(he.jsx)(xe.a,{className:"my-3",type:"submit",variant:"primary",children:"Regsiter"})]}),Object(he.jsx)(fe.a,{className:"py-3",children:Object(he.jsxs)(Oe.a,{children:["Already Registered?"," ",Object(he.jsx)(ee.Link,{to:T?"/login?redirect=".concat(T):"/login",children:"Login"})]})})]})},Fe=function(e){e.location;var t=e.history,n=Object(a.useState)(""),r=Object(Ne.a)(n,2),s=r[0],o=r[1],i=Object(a.useState)(""),u=Object(Ne.a)(i,2),l=u[0],d=u[1],p=Object(a.useState)(""),h=Object(Ne.a)(p,2),b=h[0],f=h[1],O=Object(a.useState)(""),m=Object(Ne.a)(O,2),g=m[0],x=m[1],y=Object(a.useState)(null),v=Object(Ne.a)(y,2),E=v[0],L=v[1],w=Object(c.b)(),k=Object(c.c)((function(e){return e.userDetails})),C=k.loading,N=k.error,U=k.user,A=Object(c.c)((function(e){return e.userLogin})).userInfo,T=Object(c.c)((function(e){return e.userUpdateProfile})).success;Object(a.useEffect)((function(){A?U&&U.name&&!T?(o(U.name),d(U.email)):(w({type:I}),w(pe("profile"))):t.push("/login")}),[w,t,A,U,T]);return Object(he.jsxs)(ye,{children:[Object(he.jsx)("h2",{children:"User Profile"}),E&&Object(he.jsx)(Te,{variant:"danger",children:E}),T&&Object(he.jsx)(Te,{variant:"success",children:"Profile Updated"}),C?Object(he.jsx)(Ge,{}):N?Object(he.jsx)(Te,{variant:"danger",children:N}):Object(he.jsxs)(ge.a,{onSubmit:function(e){e.preventDefault(),b!==g?L("Passwords do not match"):w(function(e){return function(){var t=Object(ue.a)(ie.a.mark((function t(n,a){var r,s,c,o,i,u;return ie.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n({type:S}),r=a(),s=r.userLogin.userInfo,c={headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s.token)}},t.next=6,de.a.put("/api/users/profile",e,c);case 6:o=t.sent,i=o.data,n({type:_,payload:i}),n({type:j,payload:i}),localStorage.setItem("userInfo",JSON.stringify(i)),t.next=18;break;case 13:t.prev=13,t.t0=t.catch(0),"Not authorized, token failed"===(u=t.t0.response&&t.t0.response.data.message?t.t0.response.data.message:t.t0.message)&&n(je()),n({type:R,payload:u});case 18:case"end":return t.stop()}}),t,null,[[0,13]])})));return function(e,n){return t.apply(this,arguments)}}()}({id:U._id,name:s,email:l,password:b}))},children:[Object(he.jsxs)(ge.a.Group,{controlId:"name",children:[Object(he.jsx)(ge.a.Label,{className:"my-2",children:"Name"}),Object(he.jsx)(ge.a.Control,{type:"name",placeholder:"Enter name",value:s,onChange:function(e){return o(e.target.value)}})]}),Object(he.jsxs)(ge.a.Group,{controlId:"email",children:[Object(he.jsx)(ge.a.Label,{className:"my-2",children:"Email Address"}),Object(he.jsx)(ge.a.Control,{type:"email",placeholder:"Enter email",value:l,onChange:function(e){return d(e.target.value)}})]}),Object(he.jsxs)(ge.a.Group,{controlId:"password",children:[Object(he.jsx)(ge.a.Label,{className:"my-2",children:"Password"}),Object(he.jsx)(ge.a.Control,{type:"password",placeholder:"Enter password",value:b,onChange:function(e){return f(e.target.value)}})]}),Object(he.jsxs)(ge.a.Group,{controlId:"confirmPassword",children:[Object(he.jsx)(ge.a.Label,{className:"my-2",children:"Confirm Password"}),Object(he.jsx)(ge.a.Control,{type:"password",placeholder:"Confirm password",value:g,onChange:function(e){return x(e.target.value)}})]}),Object(he.jsx)(xe.a,{className:"my-3",type:"submit",variant:"primary",children:"Update"})]})]})},Be=n(114),Me=function(e){var t=e.history,n=Object(c.b)(),r=Object(c.c)((function(e){return e.userList})),s=r.loading,o=r.error,i=r.users,u=Object(c.c)((function(e){return e.userLogin})).userInfo,l=Object(c.c)((function(e){return e.userDelete})).success;Object(a.useEffect)((function(){u&&u.isAdmin?n(function(){var e=Object(ue.a)(ie.a.mark((function e(t,n){var a,r,s,c,o,i;return ie.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t({type:L}),a=n(),r=a.userLogin.userInfo,s={headers:{Authorization:"Bearer ".concat(r.token)}},e.next=6,de.a.get("/api/users",s);case 6:c=e.sent,o=c.data,t({type:w,payload:o}),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(0),"Not authorized, token failed"===(i=e.t0.response&&e.t0.response.data.message?e.t0.response.data.message:e.t0.message)&&t(je()),t({type:k,payload:i});case 16:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t,n){return e.apply(this,arguments)}}()):t.push("/login")}),[n,t,l,u]);var d=function(e){window.confirm("Are you sure")&&n(function(e){return function(){var t=Object(ue.a)(ie.a.mark((function t(n,a){var r,s,c,o;return ie.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n({type:N}),r=a(),s=r.userLogin.userInfo,c={headers:{Authorization:"Bearer ".concat(s.token)}},t.next=6,de.a.delete("/api/users/".concat(e),c);case 6:n({type:U}),t.next=14;break;case 9:t.prev=9,t.t0=t.catch(0),"Not authorized, token failed"===(o=t.t0.response&&t.t0.response.data.message?t.t0.response.data.message:t.t0.message)&&n(je()),n({type:A,payload:o});case 14:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e,n){return t.apply(this,arguments)}}()}(e))};return Object(he.jsxs)(he.Fragment,{children:[Object(he.jsx)("h1",{children:"Users"}),s?Object(he.jsx)(Ge,{}):o?Object(he.jsx)(Te,{variant:"danger",children:o}):Object(he.jsxs)(Be.a,{striped:!0,bordered:!0,hover:!0,responsive:!0,className:"table-sm",children:[Object(he.jsx)("thead",{children:Object(he.jsxs)("tr",{children:[Object(he.jsx)("th",{children:"ID"}),Object(he.jsx)("th",{children:"NAME"}),Object(he.jsx)("th",{children:"EMAIL"}),Object(he.jsx)("th",{children:"ADMIN"}),Object(he.jsx)("th",{})]})}),Object(he.jsx)("tbody",{children:i.map((function(e){return Object(he.jsxs)("tr",{children:[Object(he.jsx)("td",{children:e._id}),Object(he.jsx)("td",{children:e.name}),Object(he.jsx)("td",{children:Object(he.jsx)("a",{href:"mailto:".concat(e.email),children:e.email})}),Object(he.jsx)("td",{children:e.isAdmin?Object(he.jsx)("i",{className:"fas fa-check",style:{color:"green"}}):Object(he.jsx)("i",{className:"fas fa-times",style:{color:"red"}})}),Object(he.jsxs)("td",{children:[Object(he.jsx)(ce.LinkContainer,{to:"/admin/user/".concat(e._id,"/edit"),children:Object(he.jsx)(xe.a,{variant:"light",className:"btn-sm",children:Object(he.jsx)("i",{className:"fas fa-edit"})})}),Object(he.jsx)(xe.a,{variant:"danger",className:"btn-sm",onClick:function(){return d(e._id)},children:Object(he.jsx)("i",{className:"fas fa-trash"})})]})]},e._id)}))})]})]})},Qe=function(e){var t=e.match,n=e.history,r=t.params.id,s=Object(a.useState)(""),o=Object(Ne.a)(s,2),i=o[0],u=o[1],l=Object(a.useState)(""),d=Object(Ne.a)(l,2),j=d[0],p=d[1],h=Object(a.useState)(!1),b=Object(Ne.a)(h,2),f=b[0],O=b[1],m=Object(c.b)(),g=Object(c.c)((function(e){return e.userDetails})),x=g.loading,v=g.error,S=g.user,_=Object(c.c)((function(e){return e.userUpdate})),R=_.loading,I=_.error,L=_.success;Object(a.useEffect)((function(){L?(m({type:P}),n.push("/admin/userlist")):S.name&&S._id===r?(u(S.name),p(S.email),O(S.isAdmin)):m(pe(r))}),[m,n,r,S,L]);return Object(he.jsxs)(he.Fragment,{children:[Object(he.jsx)(ee.Link,{to:"/admin/userlist",className:"btn btn-light my-3",children:"Go Back"}),Object(he.jsxs)(ye,{children:[Object(he.jsx)("h1",{children:"Edit User"}),R&&Object(he.jsx)(Ge,{}),I&&Object(he.jsx)(Te,{variant:"danger",children:I}),x?Object(he.jsx)(Ge,{}):v?Object(he.jsx)(Te,{variant:"danger",children:v}):Object(he.jsxs)(ge.a,{onSubmit:function(e){e.preventDefault(),m(function(e){return function(){var t=Object(ue.a)(ie.a.mark((function t(n,a){var r,s,c,o,i,u;return ie.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n({type:T}),r=a(),s=r.userLogin.userInfo,c={headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s.token)}},t.next=6,de.a.put("/api/users/".concat(e._id),e,c);case 6:o=t.sent,i=o.data,n({type:D}),n({type:y,payload:i}),n({type:E}),t.next=18;break;case 13:t.prev=13,t.t0=t.catch(0),"Not authorized, token failed"===(u=t.t0.response&&t.t0.response.data.message?t.t0.response.data.message:t.t0.message)&&n(je()),n({type:G,payload:u});case 18:case"end":return t.stop()}}),t,null,[[0,13]])})));return function(e,n){return t.apply(this,arguments)}}()}({_id:r,name:i,email:j,isAdmin:f}))},children:[Object(he.jsxs)(ge.a.Group,{controlId:"name",children:[Object(he.jsx)(ge.a.Label,{className:"my-2",children:"Name"}),Object(he.jsx)(ge.a.Control,{type:"name",placeholder:"Enter name",value:i,onChange:function(e){return u(e.target.value)}})]}),Object(he.jsxs)(ge.a.Group,{controlId:"email",children:[Object(he.jsx)(ge.a.Label,{className:"my-2",children:"Email Address"}),Object(he.jsx)(ge.a.Control,{type:"email",placeholder:"Enter email",value:j,onChange:function(e){return p(e.target.value)}})]}),Object(he.jsx)(ge.a.Group,{className:"my-2",controlId:"isadmin",children:Object(he.jsx)(ge.a.Check,{type:"checkbox",label:"Is Admin",checked:f,onChange:function(e){return O(e.target.checked)}})}),Object(he.jsx)(xe.a,{className:"my-2",type:"submit",variant:"primary",children:"Update"})]})]})]})},Je=function(){return Object(he.jsxs)(ee.BrowserRouter,{children:[Object(he.jsx)(be,{}),Object(he.jsx)("main",{className:"py-3",children:Object(he.jsxs)(ae.a,{children:[Object(he.jsx)(te.d,{path:"/",component:Ce,exact:!0}),Object(he.jsx)(te.d,{path:"/register",component:ze}),Object(he.jsx)(te.d,{path:"/login",component:Pe}),Object(he.jsx)(te.d,{path:"/profile",component:Fe}),Object(he.jsx)(te.d,{path:"/admin/userlist",component:Me}),Object(he.jsx)(te.d,{path:"/admin/user/:id/edit",component:Qe})]})}),Object(he.jsx)(me,{})]})};s.a.render(Object(he.jsx)(c.a,{store:$,children:Object(he.jsx)(Je,{})}),document.getElementById("root"))},79:function(e,t,n){},80:function(e,t,n){}},[[106,1,2]]]);
//# sourceMappingURL=main.82a2a302.chunk.js.map